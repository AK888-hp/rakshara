{% extends 'base.html' %}
{% block content %}
<div class="container d-flex align-items-center justify-content-center py-5">
  <div class="card p-4 shadow-lg rounded-4" style="max-width:600px;width:100%;">
    <h2 class="text-center fw-bold text-gradient mb-4">ğŸ©º Add Health Vitals</h2>

    <form method="post" id="vitalForm">
      {% csrf_token %}
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label">Heart Rate (bpm)</label>
          <input type="number" name="heart_rate" class="form-control" required>
        </div>
        <div class="col-md-6">
          <label class="form-label">SpOâ‚‚ (%)</label>
          <input type="number" name="spo2" step="0.1" class="form-control" required>
        </div>
        <div class="col-md-6">
          <label class="form-label">Breathing Rate</label>
          <input type="number" name="breathing_rate" step="0.1" class="form-control" required>
        </div>
        <div class="col-md-6">
          <label class="form-label">Temperature (Â°C)</label>
          <input type="number" name="temperature" step="0.1" class="form-control" required>
        </div>
        <div class="col-md-6">
          <label class="form-label">Height (cm)</label>
          <input type="number" name="height_cm" step="0.1" class="form-control" value="{{ student.height_cm }}">
        </div>
        <div class="col-md-6">
          <label class="form-label">Weight (kg)</label>
          <input type="number" name="weight_kg" step="0.1" class="form-control" value="{{ student.weight_kg }}">
        </div>
      </div>
      <button type="submit" class="btn btn-success w-100 mt-4 rounded-pill">Submit</button>
    </form>
  </div>
</div>

<!-- âœ… Health Result Modal -->
{% if prediction_label %}
<div class="modal fade show" id="resultModal" tabindex="-1" style="display:block; background:rgba(0,0,0,0.6);" aria-modal="true" role="dialog">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center p-4 rounded-4 shadow-lg">
      <div class="modal-body">
        {% if prediction_label == "Healthy" %}
          <div style="font-size:4rem;">ğŸ˜„</div>
        {% elif prediction_label == "Mild" %}
          <div style="font-size:4rem;">ğŸ˜</div>
        {% else %}
          <div style="font-size:4rem;">ğŸ˜Ÿ</div>
        {% endif %}
        <h3 class="fw-bold mt-3">{{ prediction_label }}</h3>
        <p class="text-muted">Prediction Score: <strong>{{ prediction_score }}</strong></p>
        <button id="okBtn" class="btn btn-primary rounded-pill px-4 mt-3">OK</button>
      </div>
    </div>
  </div>
</div>
{% endif %}

<script>
  // âœ… Redirect to dashboard when OK is clicked
  document.addEventListener("DOMContentLoaded", () => {
    const okBtn = document.getElementById("okBtn");
    if (okBtn) {
      okBtn.addEventListener("click", () => {
        window.location.href = "{% url 'student_dashboard' %}";
      });
    }
  });
</script>

<style>
.text-gradient {
  background: linear-gradient(90deg, #007bff, #00c6ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
.modal-content {
  animation: popIn 0.5s ease;
}
@keyframes popIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
</style>
{% endblock %}
